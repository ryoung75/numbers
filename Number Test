IDENTIFICATION DIVISION.
PROGRAM-ID. SolutionFile.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 INPUT-LINE 	         	PIC X (100).
01 SUB                           	PIC X
01 SUB2                         	PIC X
01 END-0F-INPUT 	PIC X VALUE 'N'.
01 SWITCH                    	PIC X.
LINKAGE SECTION.
01  STR.
      05  CHARS   		PIC S9(5).
01  RESULT.
      05  CHARS   		PIC S9(5).

PROCEDURE DIVISION.
MAIN-PROCEDURE.
PERFORM UNTIL END-OF-INPUT = ‘Y’
ACCEPT INPUT-LINE
IF INPUT-LINE = SPACE
MOVE ‘Y’ TO END-OF-INPUT
ELSE
      MOVE LENGTH OF INPUT-LINE TO SUB
DISPLAY INPUT-LINE
PERFORM VARYING SUB FROM 1 TO SUB
ACCEPT INPUT-LINE
MOVE INPUT-LINE TO CHARS OF STR
MOVE LENGTH OF INPUT-LINE TO SUB2
MOVE FUNCTION REVERSE(STR) TO RESULT.
PERFORM VARYING FROM 1 TO SUB2
IF CHARS OF STR = CHARS OF RESULT
    CONTINUE
ELSE 
ADD 1 TO CHARS OF RESULT
END-IF
DISPLAY RESULT
END-PERFORM 
END-IF
END-PERFORM	STOP RUN
